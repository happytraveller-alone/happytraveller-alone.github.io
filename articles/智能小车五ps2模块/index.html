<!doctype html><html lang=zh-Hans x-data :class=$store.darkMode.class() :data-theme=$store.darkMode.theme()><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>智能小车(五):PS2模块 | 小谢同学的修行小屋</title>
<link rel=canonical href=https://happytraveller-alone.github.io/articles/%E6%99%BA%E8%83%BD%E5%B0%8F%E8%BD%A6%E4%BA%94ps2%E6%A8%A1%E5%9D%97/><meta name=author content="YuanFeng Xie"><meta name=description content="历史回顾 智能小车(零):Arduino编程 智能小车(一):Arduino介绍 智能小车(二):超声波模块与蜂鸣器模块 智能小车(三):舵机模块与陀螺仪模块 智能小车(四):电机模块 使用 PS2 手柄控制 Arduino 电机与蜂鸣器 在这篇博客中，我们将使用 PS2 手柄控制 Arduino 控制系统，通过接收来自手柄的指令来实现对电机、蜂鸣器等外设的控制。这种手柄控制器的应用在遥控车辆、机器人等领域十分常见。接下来，我们将逐步深入，了解如何在 Arduino 上实现这一功能。
"><meta name=keywords content="Arduino,Smart_car"><meta name=generator content="Hugo 0.139.3"><meta property="og:url" content="https://happytraveller-alone.github.io/articles/%E6%99%BA%E8%83%BD%E5%B0%8F%E8%BD%A6%E4%BA%94ps2%E6%A8%A1%E5%9D%97/"><meta property="og:site_name" content="小谢同学的修行小屋"><meta property="og:title" content="智能小车(五):PS2模块"><meta property="og:description" content="历史回顾 智能小车(零):Arduino编程 智能小车(一):Arduino介绍 智能小车(二):超声波模块与蜂鸣器模块 智能小车(三):舵机模块与陀螺仪模块 智能小车(四):电机模块 使用 PS2 手柄控制 Arduino 电机与蜂鸣器 在这篇博客中，我们将使用 PS2 手柄控制 Arduino 控制系统，通过接收来自手柄的指令来实现对电机、蜂鸣器等外设的控制。这种手柄控制器的应用在遥控车辆、机器人等领域十分常见。接下来，我们将逐步深入，了解如何在 Arduino 上实现这一功能。"><meta property="og:locale" content="zh_Hans"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-10T14:07:37+08:00"><meta property="article:modified_time" content="2024-11-30T05:28:25+00:00"><meta property="article:tag" content="Arduino"><meta property="article:tag" content="Smart_car"><meta name=twitter:card content="summary"><meta name=twitter:title content="智能小车(五):PS2模块"><meta name=twitter:description content="历史回顾 智能小车(零):Arduino编程 智能小车(一):Arduino介绍 智能小车(二):超声波模块与蜂鸣器模块 智能小车(三):舵机模块与陀螺仪模块 智能小车(四):电机模块 使用 PS2 手柄控制 Arduino 电机与蜂鸣器 在这篇博客中，我们将使用 PS2 手柄控制 Arduino 控制系统，通过接收来自手柄的指令来实现对电机、蜂鸣器等外设的控制。这种手柄控制器的应用在遥控车辆、机器人等领域十分常见。接下来，我们将逐步深入，了解如何在 Arduino 上实现这一功能。"><link rel=stylesheet href=/css/output.min.css><link rel=stylesheet href=/css/code-wrap.css><link rel=stylesheet href=/css/syntax.css><style>pre{padding:1em;overflow:auto}</style><script defer src=https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js></script></head><body x-data="{
    flip: false,
  }"><div id=dream-global-bg></div><nav class="mt-4 lg:mt-8 py-4"><div class="container flex justify-between max-w-[65ch] mx-auto px-4 md:px-0"><section class="flex items-center gap-4"><div class="avatar cursor-pointer hover:online" @click="flip = !flip" title=翻转一下！><div class="h-10 rounded-full"><img src=/images/logo.png alt=小谢同学的修行小屋></div></div><div><a href=https://happytraveller-alone.github.io/ class="text-lg font-semibold cursor-pointer">小谢同学的修行小屋</a><div class="text-base-content/60 text-sm">无人扶我青云志，我自踏雪至山巅</div></div></section><div class="dropdown dropdown-end sm:hidden"><div tabindex=0 role=button class="btn btn-ghost btn-square" aria-label="Select an option"><ion-icon name=menu class=text-2xl></ion-icon></div><ul class="dropdown-content menu w-36 bg-base-100 rounded-box z-[1] shadow-md"><li><div role=link tabindex=0 class="inline-flex items-center p-2 cursor-pointer" @click="flip = !flip" title=关于我><ion-icon name=information-circle></ion-icon>关于我</div></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/posts title=归档><ion-icon name=archive></ion-icon>归档</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/categories title=所有分类><ion-icon name=grid></ion-icon>所有分类</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/tags title=所有标签><ion-icon name=pricetags></ion-icon>所有标签</a></li></ul></div><section class="hidden sm:flex sm:items-center sm:gap-2 md:gap-4"><div role=link tabindex=0 class="text-sm font-semibold cursor-pointer hover:underline" @click="flip = !flip" title=关于我>关于我</div><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href=/posts title=归档><ion-icon class=group-hover:text-primary-content name=archive></ion-icon></a><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href=/categories title=所有分类><ion-icon class=group-hover:text-primary-content name=grid></ion-icon></a><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href=/tags title=所有标签><ion-icon class=group-hover:text-primary-content name=pricetags></ion-icon></a></section></div></nav><div class=flip-container :class="{ 'flip-it': flip }"><div class=flipper><div class=front><div class=container><div class="mt-4 px-4"><div><article class="mx-auto prose prose-quoteless dark:prose-invert" id=dream-single-post-main itemscope itemtype=http://schema.org/Article><meta itemprop=name content="智能小车(五):PS2模块"><meta itemprop=description content="历史回顾 智能小车(零):Arduino编程 智能小车(一):Arduino介绍 智能小车(二):超声波模块与蜂鸣器模块 智能小车(三):舵机模块与陀螺仪模块 智能小车(四):电机模块 使用 PS2 手柄控制 Arduino 电机与蜂鸣器 在这篇博客中，我们将使用 PS2 手柄控制 Arduino 控制系统，通过接收来自手柄的指令来实现对电机、蜂鸣器等外设的控制。这种手柄控制器的应用在遥控车辆、机器人等领域十分常见。接下来，我们将逐步深入，了解如何在 Arduino 上实现这一功能。"><meta itemprop=datePublished content="2024-11-10T14:07:37+08:00"><meta itemprop=dateModified content="2024-11-30T05:28:25+00:00"><meta itemprop=wordCount content="3994"><meta itemprop=keywords content="Arduino,Smart_car"><header><h1 itemprop=headline>智能小车(五):PS2模块</h1><p class=text-sm>星期日, 11月 10, 2024
| <span>8分钟阅读</span>
| <span>更新于
星期六, 11月 30, 2024</span></p><div class="flex justify-between"><div class="flex items-center"><div class="avatar mr-1"><div class="w-8 rounded-full"><img class=my-0 src=/images/logo.jfif alt="YuanFeng Xie"></div></div><span itemprop=author itemscope itemtype=https://schema.org/Person><span itemprop=name>YuanFeng Xie</span></span></div><div class="flex items-center gap-2"><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="https://x.com/intent/post?text=%e6%99%ba%e8%83%bd%e5%b0%8f%e8%bd%a6%28%e4%ba%94%29:PS2%e6%a8%a1%e5%9d%97&amp;url=https://happytraveller-alone.github.io/articles/%E6%99%BA%E8%83%BD%E5%B0%8F%E8%BD%A6%E4%BA%94ps2%E6%A8%A1%E5%9D%97/" target=_blank rel="noopener noreferrer" title="Share on X"><ion-icon class=group-hover:text-primary-content name=logo-x></ion-icon></a><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="https://facebook.com/sharer/sharer.php?u=https://happytraveller-alone.github.io/articles/%E6%99%BA%E8%83%BD%E5%B0%8F%E8%BD%A6%E4%BA%94ps2%E6%A8%A1%E5%9D%97/" target=_blank rel="noopener noreferrer" title="Share on Facebook"><ion-icon class=group-hover:text-primary-content name=logo-facebook></ion-icon></a><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="https://wa.me/?text=%e6%99%ba%e8%83%bd%e5%b0%8f%e8%bd%a6%28%e4%ba%94%29:PS2%e6%a8%a1%e5%9d%97%20https://happytraveller-alone.github.io/articles/%E6%99%BA%E8%83%BD%E5%B0%8F%E8%BD%A6%E4%BA%94ps2%E6%A8%A1%E5%9D%97/" target=_blank rel="noopener noreferrer" title="Share on WhatsApp"><ion-icon class=group-hover:text-primary-content name=logo-whatsapp></ion-icon></a></div></div></header><h2 id=历史回顾>历史回顾</h2><ul><li><a href=https://happytraveller-alone.github.io/posts/lesson_zero_arduino_learn/>智能小车(零):Arduino编程</a></li><li><a href=https://happytraveller-alone.github.io/posts/lesson_one_arduino_and_led/>智能小车(一):Arduino介绍</a></li><li><a href=https://happytraveller-alone.github.io/posts/lesson_two_beep_and_ultrasound/>智能小车(二):超声波模块与蜂鸣器模块</a></li><li><a href=https://happytraveller-alone.github.io/posts/lesson_three_servo/>智能小车(三):舵机模块与陀螺仪模块</a></li><li><a href=https://happytraveller-alone.github.io/posts/lesson_four_motor/>智能小车(四):电机模块</a></li></ul><h2 id=使用-ps2-手柄控制-arduino-电机与蜂鸣器>使用 PS2 手柄控制 Arduino 电机与蜂鸣器</h2><p>在这篇博客中，我们将使用 PS2 手柄控制 Arduino 控制系统，通过接收来自手柄的指令来实现对电机、蜂鸣器等外设的控制。这种手柄控制器的应用在遥控车辆、机器人等领域十分常见。接下来，我们将逐步深入，了解如何在 Arduino 上实现这一功能。</p><hr><h3 id=ps2-手柄控制器简介>PS2 手柄控制器简介</h3><p>PS2 手柄是一种常用的游戏控制器，具有方向控制、按键控制和摇杆控制等多种输入方式。它能够通过串口或其他通信协议与 Arduino 进行通信，从而将用户的控制意图传达给 Arduino 系统。通过 PS2 手柄发送特定的按键或摇杆指令，Arduino 能够接收到对应的数据并进行解析，从而实现对电机、蜂鸣器等硬件的控制。</p><p>PS2 手柄通过向 Arduino 发送指令字符（如 &lsquo;A&rsquo;, &lsquo;B&rsquo;, &lsquo;C&rsquo; 等）来实现不同的动作。接下来，我们将编写一个简单的代码实例，展示如何接收手柄指令并反馈信息。</p><h3 id=基础代码示例串口接收指令并反馈>基础代码示例：串口接收指令并反馈</h3><p>首先，我们编写一个简单的 Arduino 代码，用于接收来自手柄的指令并将接收的指令打印在串口监视器上：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ino data-lang=ino><span class=line><span class=cl><span class=kt>char</span> <span class=n>cmd</span><span class=p>;</span> <span class=c1>// 接收指令
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setup</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nc>Serial</span><span class=p>.</span><span class=nf>begin</span><span class=p>(</span><span class=mi>9600</span><span class=p>);</span> <span class=c1>// 设置串口通信波特率
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>serialEvent</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>available</span><span class=p>()</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>cmd</span> <span class=o>=</span> <span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{}</span> <span class=c1>// 清除串口缓存
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>loop</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=p>(</span><span class=n>cmd</span><span class=o>==</span><span class=sc>&#39;A&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nc>Serial</span><span class=p>.</span><span class=nf>println</span><span class=p>(</span><span class=n>cmd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>cmd</span><span class=o>=</span><span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>  
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=p>(</span><span class=n>cmd</span><span class=o>==</span><span class=sc>&#39;B&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nc>Serial</span><span class=p>.</span><span class=nf>println</span><span class=p>(</span><span class=n>cmd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>cmd</span><span class=o>=</span><span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ... 其它指令
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span><span class=p>(</span><span class=n>cmd</span><span class=o>==</span><span class=sc>&#39;N&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nc>Serial</span><span class=p>.</span><span class=nf>println</span><span class=p>(</span><span class=n>cmd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>cmd</span><span class=o>=</span><span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>在上述代码中，我们通过 <code>serialEvent()</code> 函数检测串口是否有数据传入，若有数据，则读取第一个字符作为指令 <code>cmd</code>。<code>loop()</code> 函数根据 <code>cmd</code> 的值执行不同的指令反馈操作，满足了基础的串口接收功能。</p><hr><h3 id=引入看门狗机制>引入看门狗机制</h3><p>在复杂的控制系统中，保持系统稳定运行十分关键。为避免系统因卡死或出错而停止响应，我们可以引入“看门狗”机制。看门狗是一种定时器机制，能够监测系统运行状态。如果系统在特定时间内没有执行“喂狗”操作，定时器便会触发自动复位，将系统重启。</p><p>在 Arduino 中，我们可以通过 <code>avr/wdt.h</code> 库使用看门狗定时器。以下是看门狗的简单初始化方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ino data-lang=ino><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;avr/wdt.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setup</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>wdt_enable</span><span class=p>(</span><span class=n>WDTO_1S</span><span class=p>);</span> <span class=c1>// 开启看门狗，1秒超时
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>loop</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>wdt_reset</span><span class=p>();</span> <span class=c1>// 喂狗操作，重置看门狗计时器
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// 其他代码
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span></span></span></code></pre></div><p>在以上代码中，我们设置看门狗定时器为 1 秒，若 <code>loop()</code> 中每秒未执行 <code>wdt_reset()</code>，系统将自动重启。这样可以确保系统不会因未处理的错误或死循环而卡死。</p><hr><h2 id=使用-ps2-手柄控制-arduino-电机与蜂鸣器-1>使用 PS2 手柄控制 Arduino 电机与蜂鸣器</h2><p>此代码通过串口接收来自 PS2 手柄的指令，使用这些指令来控制电机、舵机、蜂鸣器、LED 等硬件设备。我们将代码分为几个主要功能模块，以便逐层理解每部分的功能。</p><hr><h3 id=1-库和变量定义>1. 库和变量定义</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-ino data-lang=ino><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;SoftPWM.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;avr/wdt.h&gt; // 看门狗</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;Servo.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=nc>Servo</span> <span class=n>myservo</span><span class=p>;</span> <span class=c1>// 舵机对象
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 电机和舵机的控制变量
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span> <span class=n>LeftUpDown</span> <span class=o>=</span> <span class=mi>128</span><span class=p>,</span> <span class=n>LeftLeftRight</span> <span class=o>=</span> <span class=mi>128</span><span class=p>,</span> <span class=n>RightUpDown</span> <span class=o>=</span> <span class=mi>128</span><span class=p>,</span> <span class=n>RightLeftRight</span> <span class=o>=</span> <span class=mi>128</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>count1</span><span class=p>,</span> <span class=n>count2</span><span class=p>,</span> <span class=n>count3</span><span class=p>,</span> <span class=n>count4</span><span class=p>,</span> <span class=nf>Min</span> <span class=o>=</span> <span class=mi>80</span><span class=p>,</span> <span class=nf>Max</span> <span class=o>=</span> <span class=mi>200</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>char</span> <span class=n>W</span><span class=p>[</span><span class=mi>4</span><span class=p>],</span> <span class=n>P</span><span class=p>[</span><span class=mi>4</span><span class=p>],</span> <span class=n>Q</span><span class=p>[</span><span class=mi>4</span><span class=p>],</span> <span class=n>S</span><span class=p>[</span><span class=mi>4</span><span class=p>];</span> <span class=c1>// 接收字符数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>float</span> <span class=n>ad</span><span class=p>,</span> <span class=n>dianya</span><span class=p>;</span> <span class=c1>// 电压相关变量
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span> <span class=n>LeftBack</span> <span class=o>=</span> <span class=mi>2</span><span class=p>,</span> <span class=n>LeftFront</span> <span class=o>=</span> <span class=mi>4</span><span class=p>,</span> <span class=n>RightBack</span> <span class=o>=</span> <span class=mi>7</span><span class=p>,</span> <span class=n>RightFront</span> <span class=o>=</span> <span class=mi>8</span><span class=p>,</span> <span class=n>TurnPin</span> <span class=o>=</span> <span class=mi>9</span><span class=p>,</span> <span class=n>Buzzerbin</span> <span class=o>=</span> <span class=mi>13</span><span class=p>,</span> <span class=n>LedPin</span> <span class=o>=</span> <span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>LedState</span> <span class=o>=</span> <span class=kc>LOW</span><span class=p>;</span> <span class=c1>// LED 初始状态
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>unsigned</span> <span class=kt>long</span> <span class=n>PreviousMillis</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>WorkMillis</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>AccelgyroWorkMillis</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>long</span> <span class=n>Interval</span> <span class=o>=</span> <span class=mi>500</span><span class=p>;</span> <span class=c1>// LED 闪烁间隔时间
</span></span></span></code></pre></div><p><strong>解释</strong>：</p><ul><li>包含了 <code>SoftPWM</code>（软件 PWM 库）和 <code>avr/wdt.h</code>（看门狗库）用于处理 PWM 输出和系统稳定性。</li><li>定义了用于控制电机和舵机的引脚及变量，这些变量将用于处理电机的前进、后退、转向控制等。</li><li><code>RockerFlag</code> 变量用于检测摇杆状态。多个字符数组 <code>W</code>、<code>P</code>、<code>Q</code> 和 <code>S</code> 用于存储不同的指令数据。</li><li><code>dianya</code> 和 <code>ad</code> 用于存储电压数据。</li></ul><hr><h3 id=2-初始化函数-setup>2. 初始化函数 <code>setup</code></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-ino data-lang=ino><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setup</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nf>pinMode</span><span class=p>(</span><span class=n>LedPin</span><span class=p>,</span> <span class=kc>OUTPUT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>pinMode</span><span class=p>(</span><span class=n>LeftBack</span><span class=p>,</span> <span class=kc>OUTPUT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>pinMode</span><span class=p>(</span><span class=n>LeftFront</span><span class=p>,</span> <span class=kc>OUTPUT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>pinMode</span><span class=p>(</span><span class=n>RightBack</span><span class=p>,</span> <span class=kc>OUTPUT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>pinMode</span><span class=p>(</span><span class=n>RightFront</span><span class=p>,</span> <span class=kc>OUTPUT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>pinMode</span><span class=p>(</span><span class=n>Buzzerbin</span><span class=p>,</span> <span class=kc>OUTPUT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nc>Serial</span><span class=p>.</span><span class=nf>begin</span><span class=p>(</span><span class=mi>9600</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>myservo</span><span class=p>.</span><span class=nf>attach</span><span class=p>(</span><span class=n>TurnPin</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>wdt_enable</span><span class=p>(</span><span class=n>WDTO_1S</span><span class=p>);</span> <span class=c1>// 开启看门狗
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>SoftPWMBegin</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p><strong>解释</strong>：</p><ul><li>设置电机和 LED 引脚模式为 <code>OUTPUT</code>，并将舵机初始化到指定引脚。</li><li>开启串口通信。</li><li><code>wdt_enable(WDTO_1S);</code> 用于开启看门狗定时器，如果系统在 1 秒内未执行 <code>wdt_reset()</code>，看门狗将复位系统。</li><li><code>SoftPWMBegin();</code> 初始化软件 PWM。</li></ul><hr><h3 id=3-led-闪烁控制-led>3. LED 闪烁控制 <code>Led()</code></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-ino data-lang=ino><span class=line><span class=cl><span class=kt>void</span> <span class=nf>Led</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kt>long</span> <span class=n>currentMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>currentMillis</span> <span class=o>-</span> <span class=n>PreviousMillis</span> <span class=o>&gt;=</span> <span class=n>Interval</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>PreviousMillis</span> <span class=o>=</span> <span class=n>currentMillis</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>LedState</span> <span class=o>=</span> <span class=o>!</span><span class=n>LedState</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nf>digitalWrite</span><span class=p>(</span><span class=n>LedPin</span><span class=p>,</span> <span class=n>LedState</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>currentMillis</span> <span class=o>-</span> <span class=n>WorkMillis</span> <span class=o>&gt;=</span> <span class=mi>50</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>WorkMillis</span> <span class=o>=</span> <span class=n>currentMillis</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Stop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p><strong>解释</strong>：</p><ul><li><code>Led()</code> 控制 LED 的闪烁，每隔 <code>Interval</code> 毫秒改变一次 <code>LedState</code> 状态，实现 LED 闪烁效果。</li><li>同时，它在超过 50 毫秒后调用 <code>Stop()</code> 函数，确保在无新指令时自动停止电机。</li></ul><hr><h3 id=4-蜂鸣器控制-vbeep-与-beep>4. 蜂鸣器控制 <code>vBeep()</code> 与 <code>Beep()</code></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-ino data-lang=ino><span class=line><span class=cl><span class=kt>void</span> <span class=nf>vBeep</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>v</span> <span class=o>=</span> <span class=nf>analogRead</span><span class=p>(</span><span class=n>A0</span><span class=p>);</span> <span class=c1>// 从 A0 读取电压
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>ad</span> <span class=o>=</span> <span class=n>v</span> <span class=o>*</span> <span class=p>(</span><span class=mf>5.0</span> <span class=o>/</span> <span class=mf>1024.0</span><span class=p>)</span> <span class=o>*</span> <span class=mf>3.1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>dianya</span> <span class=o>=</span> <span class=n>ad</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>ad</span> <span class=o>&lt;=</span> <span class=mf>5.5</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Stop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>Beep</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>160</span><span class=p>,</span> <span class=mi>500</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>delay</span><span class=p>(</span><span class=mi>2000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>Beep</span><span class=p>(</span><span class=kt>int</span> <span class=n>count</span><span class=p>,</span> <span class=kt>int</span> <span class=n>Frequency</span><span class=p>,</span> <span class=kt>int</span> <span class=n>Time</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>count</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>q</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>q</span> <span class=o>&lt;</span> <span class=mi>500</span><span class=p>;</span> <span class=n>q</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nf>digitalWrite</span><span class=p>(</span><span class=n>Buzzerbin</span><span class=p>,</span> <span class=kc>HIGH</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nf>delayMicroseconds</span><span class=p>(</span><span class=n>Frequency</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nf>digitalWrite</span><span class=p>(</span><span class=n>Buzzerbin</span><span class=p>,</span> <span class=kc>LOW</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nf>delayMicroseconds</span><span class=p>(</span><span class=n>Frequency</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nf>delay</span><span class=p>(</span><span class=n>Time</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p><strong>解释</strong>：</p><ul><li><code>vBeep()</code> 用于监控电压，当电压低于设定值（5.5V）时，停止电机并调用 <code>Beep()</code> 发出蜂鸣。</li><li><code>Beep()</code> 控制蜂鸣器发声，根据频率和时间产生不同的蜂鸣效果。</li></ul><hr><h3 id=5-电机与舵机控制-output-与-electricmachinery>5. 电机与舵机控制 <code>Output()</code> 与 <code>ElectricMachinery()</code></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-ino data-lang=ino><span class=line><span class=cl><span class=kt>void</span> <span class=nf>Output</span><span class=p>(</span><span class=kt>int</span> <span class=n>TurnCount</span><span class=p>,</span> <span class=kt>int</span> <span class=n>FrontCount</span><span class=p>,</span> <span class=kt>int</span> <span class=n>BackCount</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>myservo</span><span class=p>.</span><span class=nf>write</span><span class=p>(</span><span class=n>TurnCount</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>SoftPWMSet</span><span class=p>(</span><span class=n>LeftFront</span><span class=p>,</span> <span class=n>FrontCount</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>SoftPWMSet</span><span class=p>(</span><span class=n>RightFront</span><span class=p>,</span> <span class=n>FrontCount</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>SoftPWMSet</span><span class=p>(</span><span class=n>LeftBack</span><span class=p>,</span> <span class=n>BackCount</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>SoftPWMSet</span><span class=p>(</span><span class=n>RightBack</span><span class=p>,</span> <span class=n>BackCount</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>ElectricMachinery</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>LeftUpDown</span> <span class=o>&gt;=</span> <span class=mi>127</span> <span class=o>&amp;&amp;</span> <span class=n>LeftUpDown</span> <span class=o>&lt;=</span> <span class=mi>129</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>LeftLeftRight</span> <span class=o>&gt;=</span> <span class=mi>127</span> <span class=o>&amp;&amp;</span> <span class=n>LeftLeftRight</span> <span class=o>&lt;=</span> <span class=mi>129</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>Stop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>LeftLeftRight</span> <span class=o>&lt;</span> <span class=mi>127</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>Left</span><span class=p>(</span><span class=nf>map</span><span class=p>(</span><span class=n>LeftLeftRight</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>90</span><span class=p>),</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>LeftLeftRight</span> <span class=o>&gt;</span> <span class=mi>129</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>Right</span><span class=p>(</span><span class=nf>map</span><span class=p>(</span><span class=n>LeftLeftRight</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>150</span><span class=p>),</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>LeftUpDown</span> <span class=o>&lt;</span> <span class=mi>127</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Front</span><span class=p>(</span><span class=nf>map</span><span class=p>(</span><span class=n>LeftLeftRight</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>150</span><span class=p>),</span> <span class=nf>map</span><span class=p>(</span><span class=n>LeftUpDown</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>255</span><span class=p>),</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>LeftUpDown</span> <span class=o>&gt;</span> <span class=mi>129</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Back</span><span class=p>(</span><span class=nf>map</span><span class=p>(</span><span class=n>LeftLeftRight</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>150</span><span class=p>),</span> <span class=mi>0</span><span class=p>,</span> <span class=nf>map</span><span class=p>(</span><span class=n>LeftUpDown</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>255</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p><strong>解释</strong>：</p><ul><li><code>Output()</code> 设置电机前后动力和舵机转向，通过 PWM 调节各电机的输出，实现速度控制。</li><li><code>ElectricMachinery()</code> 根据摇杆指令决定电机和舵机的动作。例如，若 <code>LeftUpDown</code> 在中立位置，则停止所有电机；根据摇杆位置可以实现前进、后退、左右转向等功能。</li></ul><hr><h3 id=6-串口接收函数-serialevent>6. 串口接收函数 <code>serialEvent()</code></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-ino data-lang=ino><span class=line><span class=cl><span class=kt>void</span> <span class=nf>serialEvent</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=n>inchar</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 清空缓存,避免重复读取
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>static</span> <span class=kt>void</span> <span class=n>clearSerialBuffer</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 处理摇杆数据
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>static</span> <span class=kt>void</span> <span class=n>handleRockerData</span><span class=p>(</span><span class=kt>char</span><span class=o>*</span> <span class=kt>array</span><span class=p>,</span> <span class=kt>uint8_t</span><span class=o>*</span> <span class=n>count</span><span class=p>,</span> <span class=kt>uint8_t</span><span class=o>*</span> <span class=n>value</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=o>*</span><span class=n>count</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=o>*</span><span class=n>value</span> <span class=o>=</span> <span class=kt>array</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=sc>&#39;0&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=o>*</span><span class=n>count</span> <span class=o>==</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=o>*</span><span class=n>value</span> <span class=o>=</span> <span class=p>(</span><span class=kt>array</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=sc>&#39;0&#39;</span><span class=p>)</span> <span class=o>*</span> <span class=mi>10</span> <span class=o>+</span> <span class=p>(</span><span class=kt>array</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=sc>&#39;0&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=o>*</span><span class=n>count</span> <span class=o>==</span> <span class=mi>3</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=o>*</span><span class=n>value</span> <span class=o>=</span> <span class=p>(</span><span class=kt>array</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=sc>&#39;0&#39;</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span> <span class=o>+</span> <span class=p>(</span><span class=kt>array</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=sc>&#39;0&#39;</span><span class=p>)</span> <span class=o>*</span> <span class=mi>10</span> <span class=o>+</span> <span class=p>(</span><span class=kt>array</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>-</span> <span class=sc>&#39;0&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 重置摇杆参数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>static</span> <span class=kt>void</span> <span class=n>resetRocker</span><span class=p>(</span><span class=kt>char</span> <span class=n>flag</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>RockerFlag</span> <span class=o>=</span> <span class=n>flag</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>1</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>count1</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>memset</span><span class=p>(</span><span class=n>W</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>W</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>2</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>count2</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>memset</span><span class=p>(</span><span class=n>P</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>P</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>3</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>count3</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>memset</span><span class=p>(</span><span class=n>Q</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>Q</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>4</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>count4</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>memset</span><span class=p>(</span><span class=n>S</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>S</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>available</span><span class=p>()</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>inchar</span> <span class=o>=</span> <span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 使用switch-case替代多个if语句
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>switch</span><span class=p>(</span><span class=n>inchar</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;A&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=n>Front</span><span class=p>(</span><span class=mi>90</span><span class=p>,</span> <span class=nf>Max</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=n>clearSerialBuffer</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;B&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=n>Back</span><span class=p>(</span><span class=mi>90</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nf>Max</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=n>clearSerialBuffer</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;C&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=n>Left</span><span class=p>(</span><span class=mi>30</span><span class=p>,</span> <span class=nf>Max</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=n>clearSerialBuffer</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;D&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=n>Right</span><span class=p>(</span><span class=mi>150</span><span class=p>,</span> <span class=nf>Max</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=n>clearSerialBuffer</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;E&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=nf>Max</span> <span class=o>&lt;</span> <span class=mi>250</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nf>Max</span> <span class=o>+=</span> <span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=n>Beep</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>130</span><span class=p>,</span> <span class=mi>100</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>Beep</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>160</span><span class=p>,</span> <span class=mi>500</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=n>clearSerialBuffer</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;F&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=nf>Max</span> <span class=o>&gt;</span> <span class=nf>Min</span> <span class=o>+</span> <span class=mi>10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nf>Max</span> <span class=o>-=</span> <span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=n>Beep</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>130</span><span class=p>,</span> <span class=mi>100</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>Beep</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>160</span><span class=p>,</span> <span class=mi>500</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=n>clearSerialBuffer</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;H&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>Stop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=nf>Min</span> <span class=o>=</span> <span class=mi>80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nf>Max</span> <span class=o>=</span> <span class=mi>150</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>LeftUpDown</span> <span class=o>=</span> <span class=mi>128</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>LeftLeftRight</span> <span class=o>=</span> <span class=mi>128</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>RightUpDown</span> <span class=o>=</span> <span class=mi>128</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>RightLeftRight</span> <span class=o>=</span> <span class=mi>128</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>count1</span> <span class=o>=</span> <span class=n>count2</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>memset</span><span class=p>(</span><span class=n>W</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>W</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                <span class=n>memset</span><span class=p>(</span><span class=n>P</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>P</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=n>clearSerialBuffer</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;L&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>Beep</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>500</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=n>clearSerialBuffer</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;M&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=n>Left</span><span class=p>(</span><span class=mi>30</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nf>Max</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=n>clearSerialBuffer</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;N&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=n>Right</span><span class=p>(</span><span class=mi>150</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nf>Max</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=n>clearSerialBuffer</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;V&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=nc>Serial</span><span class=p>.</span><span class=nf>println</span><span class=p>(</span><span class=n>ad</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=n>clearSerialBuffer</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;W&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>resetRocker</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;P&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>resetRocker</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;Q&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>resetRocker</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=sc>&#39;S&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=n>resetRocker</span><span class=p>(</span><span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 处理摇杆数据
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span><span class=p>(</span><span class=n>RockerFlag</span> <span class=o>&amp;&amp;</span> <span class=nf>isDigit</span><span class=p>(</span><span class=n>inchar</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>switch</span><span class=p>(</span><span class=n>RockerFlag</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=mi>1</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>W</span><span class=p>[</span><span class=n>count1</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>inchar</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=n>handleRockerData</span><span class=p>(</span><span class=n>P</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>count2</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>LeftLeftRight</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=mi>2</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>P</span><span class=p>[</span><span class=n>count2</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>inchar</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=n>handleRockerData</span><span class=p>(</span><span class=n>W</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>count1</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>LeftUpDown</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=mi>3</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>Q</span><span class=p>[</span><span class=n>count3</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>inchar</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>case</span> <span class=mi>4</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>S</span><span class=p>[</span><span class=n>count4</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>inchar</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 防止数组越界
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>count1</span> <span class=o>=</span> <span class=p>(</span><span class=n>count1</span> <span class=o>&gt;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>?</span> <span class=mi>0</span> <span class=o>:</span> <span class=n>count1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>count2</span> <span class=o>=</span> <span class=p>(</span><span class=n>count2</span> <span class=o>&gt;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>?</span> <span class=mi>0</span> <span class=o>:</span> <span class=n>count2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>count3</span> <span class=o>=</span> <span class=p>(</span><span class=n>count3</span> <span class=o>&gt;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>?</span> <span class=mi>0</span> <span class=o>:</span> <span class=n>count3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>count4</span> <span class=o>=</span> <span class=p>(</span><span class=n>count4</span> <span class=o>&gt;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>?</span> <span class=mi>0</span> <span class=o>:</span> <span class=n>count4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p><strong>解释</strong>：</p><ul><li><code>serialEvent()</code> 检查串口是否有数据并读取输入字符，通过不同字符控制电机动作。例如：<ul><li><code>'A'</code>：前进</li><li><code>'B'</code>：后退</li><li><code>'C'</code> 和 <code>'D'</code>：分别为左转和右转。</li></ul></li><li>该函数通过设置 <code>RockerFlag</code> 控制不同方向或停止状态。</li></ul><hr><h3 id=7-主循环-loop>7. 主循环 <code>loop()</code></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-ino data-lang=ino><span class=line><span class=cl><span class=kt>void</span> <span class=nf>loop</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>wdt_reset</span><span class=p>();</span> <span class=c1>// 喂狗，重置看门狗计时
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>vBeep</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=n>Led</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>RockerFlag</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ElectricMachinery</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p><strong>解释</strong>：</p><ul><li><code>loop()</code> 是代码的核心执行循环。每次循环中，重置看门狗定时器 (<code>wdt_reset()</code>)，确保系统不会因超时而复位。</li><li>调用 <code>vBeep()</code> 检查电压并控制蜂鸣器，<code>Led()</code> 控制 LED 闪烁，<code>ElectricMachinery()</code> 实现电机动作控制。</li><li>没有<code>SerialEvent</code>函数的原因：包含在core文件中，属于弱函数，可用强符号函数（普通函数）覆盖定义</li><li>arduino代码的时间执行过程</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>main() 
</span></span><span style=display:flex><span>  │
</span></span><span style=display:flex><span>  ├─► setup()
</span></span><span style=display:flex><span>  │
</span></span><span style=display:flex><span>  └─► 无限循环
</span></span><span style=display:flex><span>       │
</span></span><span style=display:flex><span>       ├─► loop()
</span></span><span style=display:flex><span>       │
</span></span><span style=display:flex><span>       └─► serialEventRun()
</span></span><span style=display:flex><span>           │
</span></span><span style=display:flex><span>           └─► serialEvent() (如果Serial有数据)
</span></span></code></pre></div><ul><li>arduino的main函数实现</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>// Arduino核心的main函数实现 (main.cpp)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>void</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 初始化工作
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    init();
</span></span><span style=display:flex><span>    initVariant();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#75715e>#if defined(USBCON)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    USBDevice.attach();
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 调用用户setup
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    setup();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 主循环
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (;;) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 调用用户loop
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        loop();
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 检查串口事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (serialEventRun) 
</span></span><span style=display:flex><span>            serialEventRun();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>serialEvent函数的查看</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>// HardwareSerial.cpp中的实现
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>serialEventRun</span>(<span style=color:#66d9ef>void</span>) {
</span></span><span style=display:flex><span><span style=color:#75715e>#if defined(HAVE_HWSERIAL0)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (Serial0_available <span style=color:#f92672>&amp;&amp;</span> serialEvent <span style=color:#f92672>&amp;&amp;</span> Serial.available())
</span></span><span style=display:flex><span>        serialEvent();
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e>#if defined(HAVE_HWSERIAL1)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (Serial1_available <span style=color:#f92672>&amp;&amp;</span> serialEvent1 <span style=color:#f92672>&amp;&amp;</span> Serial1.available())
</span></span><span style=display:flex><span>        serialEvent1();
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e>#if defined(HAVE_HWSERIAL2)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (Serial2_available <span style=color:#f92672>&amp;&amp;</span> serialEvent2 <span style=color:#f92672>&amp;&amp;</span> Serial2.available())
</span></span><span style=display:flex><span>        serialEvent2();
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e>#if defined(HAVE_HWSERIAL3)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (Serial3_available <span style=color:#f92672>&amp;&amp;</span> serialEvent3 <span style=color:#f92672>&amp;&amp;</span> Serial3.available())
</span></span><span style=display:flex><span>        serialEvent3();
</span></span><span style=display:flex><span><span style=color:#75715e>#endif
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><hr><h2 id=总结>总结</h2><p>这段代码通过串口接收 PS2 手柄的指令来控制电机、舵机和蜂鸣器，具有 LED 指示和低电压报警功能。代码结构模块化、易扩展，并加入了看门狗机制确保系统稳定性。通过将指令与控制逻辑分离，不仅可以方便地扩展不同的控制模式，还能适应更多类型的外设，使整个系统更加灵活和可靠。</p><ul><li>串口控制：通过串口接收 PS2 手柄的指令，系统能够实现前进、后退、转向等功能，并能根据收到的不同字符指令控制不同的硬件动作。</li><li>看门狗机制：通过看门狗机制，系统在出现卡顿或无法正常响应时自动复位，确保系统的长时间稳定运行。</li><li>蜂鸣器和 LED 指示：蜂鸣器用于低电压报警，LED 则用于指示系统状态，这些都提升了系统的可用性。</li><li>PWM 与舵机控制：使用软件 PWM 控制电机输出强度，舵机用于精确控制方向，适用于控制车轮的转向或其他机械动作。</li></ul><h3 id=serialevent函数简化版本><code>serialEvent()</code>函数简化版本</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-ino data-lang=ino><span class=line><span class=cl><span class=kt>void</span> <span class=nf>serialEvent</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>available</span><span class=p>()</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=c1>//一直等待数据接收完成 用if的话loop函数执行一次接受1个字符
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=n>inchar</span> <span class=o>=</span> <span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;A&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=n>Front</span><span class=p>(</span> <span class=mi>90</span><span class=p>,</span> <span class=nf>Max</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>inchar</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;B&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=n>Back</span><span class=p>(</span><span class=mi>90</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nf>Max</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>inchar</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;C&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=n>Left</span><span class=p>(</span><span class=mi>30</span><span class=p>,</span> <span class=nf>Max</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>inchar</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;D&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=n>Right</span><span class=p>(</span><span class=mi>150</span><span class=p>,</span> <span class=nf>Max</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>inchar</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;E&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nf>Max</span> <span class=o>&lt;</span> <span class=mi>250</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>Max</span> <span class=o>+=</span> <span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>Beep</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>130</span> <span class=p>,</span> <span class=mi>100</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>inchar</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>else</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Beep</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>160</span><span class=p>,</span> <span class=mi>500</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>inchar</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;F&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nf>Max</span> <span class=o>&gt;</span> <span class=nf>Min</span> <span class=o>+</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>Max</span> <span class=o>-=</span> <span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>Beep</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>130</span><span class=p>,</span> <span class=mi>100</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>inchar</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>else</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Beep</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>160</span><span class=p>,</span> <span class=mi>500</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>inchar</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;G&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=n>inchar</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;H&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>Stop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=nf>Min</span> <span class=o>=</span> <span class=mi>80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nf>Max</span> <span class=o>=</span> <span class=mi>150</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>LeftUpDown</span> <span class=o>=</span> <span class=mi>128</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>LeftLeftRight</span> <span class=o>=</span> <span class=mi>128</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>RightUpDown</span> <span class=o>=</span> <span class=mi>128</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>RightLeftRight</span> <span class=o>=</span> <span class=mi>128</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>count1</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>count2</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>memset</span><span class=p>(</span><span class=n>W</span><span class=p>,</span> <span class=kt>NULL</span><span class=p>,</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>memset</span><span class=p>(</span><span class=n>P</span><span class=p>,</span> <span class=kt>NULL</span><span class=p>,</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>inchar</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;I&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>                  <span class=c1>//更新当前电机工作时间状态
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=n>inchar</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;J&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=n>inchar</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;K&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=n>inchar</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;L&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>Beep</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>90</span><span class=p>,</span><span class=mi>500</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=n>inchar</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;M&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=n>Left</span><span class=p>(</span><span class=mi>30</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nf>Max</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>inchar</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;N&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=n>Right</span><span class=p>(</span><span class=mi>150</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nf>Max</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>inchar</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;V&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>inchar</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=c1>//        Serial.print(&#34;Voltage:&#34;);
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nc>Serial</span><span class=p>.</span><span class=nf>println</span><span class=p>(</span><span class=n>ad</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>while</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>.</span><span class=nf>read</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;W&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=n>count1</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>memset</span><span class=p>(</span><span class=n>W</span><span class=p>,</span> <span class=kt>NULL</span><span class=p>,</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;P&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=n>count2</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>memset</span><span class=p>(</span><span class=n>P</span><span class=p>,</span> <span class=kt>NULL</span><span class=p>,</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;Q&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=n>count3</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>memset</span><span class=p>(</span><span class=n>Q</span><span class=p>,</span> <span class=kt>NULL</span><span class=p>,</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>inchar</span> <span class=o>==</span> <span class=sc>&#39;S&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>RockerFlag</span> <span class=o>=</span> <span class=mi>4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>WorkMillis</span> <span class=o>=</span> <span class=nf>millis</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=n>count4</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>memset</span><span class=p>(</span><span class=n>S</span><span class=p>,</span> <span class=kt>NULL</span><span class=p>,</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>RockerFlag</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nf>isDigit</span><span class=p>(</span><span class=n>inchar</span><span class=p>))</span> <span class=c1>//是数字就执行
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>W</span><span class=p>[</span><span class=n>count1</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>inchar</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>count2</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>LeftLeftRight</span> <span class=o>=</span> <span class=n>P</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mi>48</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>count2</span> <span class=o>==</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>LeftLeftRight</span> <span class=o>=</span> <span class=p>(</span><span class=n>P</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mi>48</span><span class=p>)</span> <span class=o>*</span> <span class=mi>10</span> <span class=o>+</span> <span class=p>(</span><span class=n>P</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=mi>48</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>count2</span> <span class=o>==</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>LeftLeftRight</span> <span class=o>=</span> <span class=p>(</span><span class=n>P</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mi>48</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span> <span class=o>+</span> <span class=p>(</span><span class=n>P</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=mi>48</span><span class=p>)</span> <span class=o>*</span> <span class=mi>10</span> <span class=o>+</span> <span class=p>(</span><span class=n>P</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span> <span class=o>-</span> <span class=mi>48</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>RockerFlag</span> <span class=o>==</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nf>isDigit</span><span class=p>(</span><span class=n>inchar</span><span class=p>))</span> <span class=c1>//是数字就执行
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>P</span><span class=p>[</span><span class=n>count2</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>inchar</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>count1</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>LeftUpDown</span> <span class=o>=</span> <span class=n>W</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mi>48</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>count1</span> <span class=o>==</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>LeftUpDown</span> <span class=o>=</span> <span class=p>(</span><span class=n>W</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mi>48</span><span class=p>)</span> <span class=o>*</span> <span class=mi>10</span> <span class=o>+</span> <span class=p>(</span><span class=n>W</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=mi>48</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>count1</span> <span class=o>==</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>LeftUpDown</span> <span class=o>=</span> <span class=p>(</span><span class=n>W</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=mi>48</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span> <span class=o>+</span> <span class=p>(</span><span class=n>W</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=mi>48</span><span class=p>)</span> <span class=o>*</span> <span class=mi>10</span> <span class=o>+</span> <span class=p>(</span><span class=n>W</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span> <span class=o>-</span> <span class=mi>48</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>RockerFlag</span> <span class=o>==</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nf>isDigit</span><span class=p>(</span><span class=n>inchar</span><span class=p>))</span> <span class=c1>//是数字就执行
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Q</span><span class=p>[</span><span class=n>count3</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>inchar</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>RockerFlag</span> <span class=o>==</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nf>isDigit</span><span class=p>(</span><span class=n>inchar</span><span class=p>))</span> <span class=c1>//是数字就执行
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>S</span><span class=p>[</span><span class=n>count4</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>inchar</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>count1</span> <span class=o>&gt;</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>count1</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>count2</span> <span class=o>&gt;</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>count2</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>count3</span> <span class=o>&gt;</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>count3</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>count4</span> <span class=o>&gt;</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>count4</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></article></div></div><footer class="flex justify-between items-center gap-2 max-w-[65ch] mx-auto px-4 md:px-0 py-12"><div><p>© 2024 小谢同学的修行小屋</p><p class=text-sm>🌱
<span class=text-base-content/60>Powered by <a class=hover:underline href=https://gohugo.io/ target=_blank>Hugo</a> with theme
<a class=hover:underline href=https://github.com/g1eny0ung/hugo-theme-dream target=_blank>Dream</a>.</span></p></div><div x-data="{ icons: [
    { name: 'moon', status: 'y' },
    { name: 'sunny', status: 'n' },
    { name: 'desktop', status: 'auto' }
  ] }" class="flex items-center h-[32px] px-2 gap-2 border border-base-content/30 rounded-full"><template x-for="icon in icons"><div role=button tabindex=0 :aria-label="'Select ' + icon.name + ' mode'" class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary" :class="$store.darkMode.icon() === icon.name && 'bg-primary'" @click=$store.darkMode.toggle(icon.status)><ion-icon :name="`${icon.name}-outline`" class=group-hover:text-primary-content :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"></ion-icon></div></template></div></footer></div></div><div class=back><div class=container><div class="max-w-[65ch] mt-8 mx-auto px-4"><div><div class="mb-4 text-lg font-medium">关于我</div><div class="prose dark:prose-invert"><p><figure><img src=/resume/profile2.png width=100></figure>一名喜欢RUST的菜鸟程序员</p><h4 id=教育背景研二在读>教育背景（研二在读）</h4><ul><li>2019.09 - 2023.06 天津大学 · 智能与计算学部 · 网络安全专业 · 全日制 · 本科</li><li>2023.09 - 2026.06 天津大学 · 智能与计算学部 · 电子信息专业 · 全日制 · 硕士研究生</li></ul></div></div><div class="divider divider-vertical"></div><div><div class="mb-4 text-lg font-medium">浏览器漏洞挖掘项目</div><div class="prose dark:prose-invert"><p><strong>V8引擎的模糊测试工具改进</strong></p><p>时间：2021.09-2022.04</p><p>内容：聚焦于优化JavaScript引擎的测试方法。研究团队基于SOAT改进部署了V8引擎测试环境，并通过分析测例覆盖率和已知CVE，优化了测试流程。</p><p>成果：成功捕获了一个谷歌引擎的<a href="https://bugs.chromium.org/p/v8/issues/detail?id=12563">逻辑漏洞</a>，获得了修复反馈</p><p><strong>JS引擎WASM模块漏洞挖掘研究</strong></p><p>时间：2023.11-2024.4</p><p>内容：阅读标准手动编写了WASM语法规则，调研了主流JS引擎的WASM支持情况，并基于V8构建了WASM二进制框架。</p><p>成果：<a href=https://github.com/happytraveller-alone/antlr_wat/tree/main/wat_grammar_check_java>语法规则</a>、调研报告和<a href=https://github.com/happytraveller-alone/antlr_wat/tree/main/wasm_domato>二进制构建框架</a>，成功捕获<a href="https://bugs.webkit.org/show_bug.cgi?id=271030">特性缺陷</a>并得到修复</p></div></div><div class="divider divider-vertical"></div><div><div class="mb-4 text-lg font-medium">数据库缺陷研究项目</div><div class="prose dark:prose-invert"><p><strong>关系型数据库缺陷的实证研究</strong></p><p>时间：2022.12-2023.11</p><p>内容：通过构建统一的数据库逻辑框架，系统收集并分析了大量数据库缺陷。对777个缺陷进行了深入分析，特别聚焦SQL数据类型问题，并据此改进了模糊测试方法。</p><p>成果：构建<a href=https://github.com/sqlttest/SQLT/blob/main/dataset.xlsx>缺陷数据集</a>, 开发<a href=https://github.com/sqlttest/SQLT>SQLT测试框架</a>。</p></div></div><div class="divider divider-vertical"></div><div><div class="mb-4 text-lg font-medium">网络协议漏洞挖掘项目</div><div class="prose dark:prose-invert"><p><strong>基于 RFC的 SSL/TLS模糊测试</strong></p><p>时间：2024.4 – today</p><p>内容：梳理TLS协议模糊测试的相关工作，关注基于状态机的网络协议模糊测试方法。复现历史漏洞，了解TLS报文结构，追溯相关漏洞代码。分析RFC文档，提取字段约束，构建状态转移范式，并据此完善了TLS协议的有限状态机模型。</p><p>成果：完成相关工作调研, 漏洞复现报告, <strong>状态范式数据集</strong></p></div></div><div class="divider divider-vertical"></div></div></div></div></div></div><script>window.lightTheme="emerald",window.darkTheme="forest"</script><script src=/js/main.min.js></script><script type=module src=https://unpkg.com/ionicons@7.4.0/dist/ionicons/ionicons.esm.js></script><script nomodule src=https://unpkg.com/ionicons@7.4.0/dist/ionicons/ionicons.js></script><script defer src=/js/clipboard/clipboard.js></script><link rel=stylesheet href=/css/copy-paste.css></body></html>